{
  "hash": "f83381cf3bffbb140f8d3c00567e8856",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Stable Reduced-Bias Estimation of Structural Equation Models using Plugin Penalties\nauthors:\n  - name: Oliver Kemp\n    # orcid: \n    email: Oliver.Kemp@warwick.ac.uk\n    affiliations:\n      - name: University of Warwick\n        id: warwick\n        department: Department of Statistics\n        address: Zeeman Building, University of Warwick\n        city: Coventry\n        country: United Kingdom\n        postal-code: CV4 7AL\n  - name: Ioannis Kosmidis\n    email: ioannis.kosmidis@warwick.ac.uk\n    orcid: 0000-0003-1556-0302\n    affiliations:\n      - ref: warwick\n  - name: Haziq Jamil\n    orcid: 0000-0003-3298-1010\n    email: haziq.jamil@ubd.edu.bn\n    # corresponding: true\n    url: \"https://haziqj.ml\"\n    affiliations:\n      - name: Universiti Brunei Darussalam\n        id: ubd\n        department: Mathematical Sciences, Faculty of Science\n        address: Universiti Brunei Darussalam, Jalan Tungku Link\n        city: Bandar Seri Begawan\n        country: Brunei\n        postal-code: BE 1410\n      - name: London School of Economics and Political Science\n        id: lse\n        department: Department of Statistics\n        address: Columbia House, Houghton Street\n        city: London\n        country: United Kingdom\n        postal-code: WC2A 2AE\n  - name: Yves Rosseel\n    orcid: 0000-0002-4129-4477\n    email: Yves.Rosseel@UGent.be\n    affiliations:\n      - name: Ghent University\n        id: ugent\n        department: Center for Data Analysis and Statistical Science\n        address: Krijgslaan 281 - S9\n        city: Gent\n        country: Belgium\n        postal-code: 9000      \ndate-modified: last-modified\nnocite: |\n  @*\nabstract: |\n  {{< lipsum 1 >}}\nkeywords:\n  - Structural Equation Models\n  - Growth Curve Models\n  - Bias Reduction\n---\n\n::: {.cell .hidden}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(brlavaan)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: lavaan\nThis is lavaan 0.6-19\nlavaan is FREE software! Please report any bugs.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(gt)\nlibrary(glue)\n# library(semPlot)\n# library(semptools)\n# here::i_am(\"manuscript/index.qmd\")\n# load(here::here(\"experiments/results.RData\"))\n```\n:::\n\n## Introduction\n\nFor the iRBM method, we can use an additional plugin penalty to the objective function. \nThe plugin penalty acts to shrink the parameter estimates towards some value, thus ensuring that the estimates are finite.\nIn some cases it might make sense to have penalties shrink to zero, but for others, this is a bit too harsh (e.g. variance parameters or other parameters which are in truth far away from zero).\nIn these cases, it is more useful to implement a bounded penalty, where such a function acts within a pre-specified parameter range, and penalises the objective function if the parameter estimates stray to the boundaries.\nYet another penalty function that will be explored is a penalty function that shrinks the estimates towards some \"ideal\" variance-covariance matrix.\n\n\nHere are the penalty functions:\n\n1. **Ridge penalty (to target $x^*$)**\n$$\nf(x) = \\Vert x - x^* \\Vert^2\n$$\n   Here, $x^*$ could be ideal parameter values, or could be used in conjunction with bounds where $x^*$ is the midpoint of the bounds.\n\n2. **Ridge penalty with bounds $l \\leq x \\leq u$**\n$$\nf(x) = \\begin{cases}\n0 & \\text{if } l \\leq x \\leq u \\\\\n\\Vert x - l \\Vert^2 & \\text{if } x < l \\\\\n\\Vert x - u \\Vert^2 & \\text{if } x > u\n\\end{cases}\n$$\n\n3. **Huber penalty with bounds $l \\leq x \\leq u$**\n$$\nf(x) =  \\begin{cases} \n\\frac{1}{2} y^2 & \\text{if } |y| < \\tau, \\\\[10pt]\n-\\tau \\left(\\frac{\\tau}{2} - |y|\\right) & \\text{if } |y| \\geq \\tau,\n\\end{cases}\n$$\nwhere $\\tau$ is some threshold (defaults to 1), and \n$$\ny =\n\\begin{cases} \n\\log\\left(\\frac{x - l}{u - x}\\right) & \\text{if } l,u < \\infty \\\\\n\\log(x - l) & \\text{if } l < \\infty, u = \\infty \\\\\n0 & \\text{if } l,u = \\infty\n\\end{cases}\n$$\n\n4. **Matrix norm to target matrix**\n   \n   To be developed!\n\n\n### Comparison of penalty functions\n\n::: {#cell-fig-penalty-functions .cell}\n\n```{.r .cell-code .hidden}\nlb <- 0\nub <- 3\ntibble(\n  x = seq(-2, 5, length.out = 250)\n) |>\n  rowwise() |>\n  mutate(\n    ridge = brlavaan:::pen_ridge(x),\n    ridge_bounded = brlavaan:::pen_ridge_bound(x, lb = lb, ub = ub),\n    huber_bounded = brlavaan:::pen_huber(x, lb = lb, ub = ub),\n    huber_left_bounded = brlavaan:::pen_huber(x, lb = lb, ub = Inf)\n  ) |> \n  pivot_longer(-x) |>\n  ggplot(aes(x, value, color = name)) +\n  annotate(\"rect\", xmin = lb, xmax = ub, ymin = -Inf, ymax = Inf, alpha = 0.2) +\n  geom_line() +\n  geom_vline(xintercept = c(lb, ub), linetype = \"dashed\") +\n  labs(y = \"f(x)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Comparison of penalty functions.](index_files/figure-html/fig-penalty-functions-1.png){#fig-penalty-functions width=672}\n:::\n:::\n\n### Comparing Huber penalty thresholds\n\n::: {#cell-fig-huber-comparison .cell}\n\n```{.r .cell-code .hidden}\nlb <- -1\nub <- 4\ntibble(\n  x = seq(-2, 5, length.out = 250)\n) |>\n  rowwise() |>\n  mutate(\n    `0.5` = brlavaan:::pen_huber(x, lb = lb, ub = ub, thres = 0.5),\n    `1` = brlavaan:::pen_huber(x, lb = lb, ub = ub, thres = 1),\n    `2` = brlavaan:::pen_huber(x, lb = lb, ub = ub, thres = 2)\n  ) |> \n  pivot_longer(-x) |>\n  ggplot(aes(x, value, color = name)) +\n  annotate(\"rect\", xmin = lb, xmax = ub, ymin = -Inf, ymax = Inf, alpha = 0.2) +\n  geom_line() +\n  geom_vline(xintercept = c(lb, ub), linetype = \"dashed\") +\n  labs(y = \"f(x)\", col = \"Threshold\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Comparison of Huber penalty functions with different thresholds.](index_files/figure-html/fig-huber-comparison-1.png){#fig-huber-comparison width=672}\n:::\n:::\n\n\n::: {#cell-fig-huber-comparison-left-bounded .cell}\n\n```{.r .cell-code .hidden}\nlb <- -1\nub <- 4\ntibble(\n  x = seq(-2, 5, length.out = 250)\n) |>\n  rowwise() |>\n  mutate(\n    `0.5` = brlavaan:::pen_huber(x, lb = lb, ub = Inf, thres = 0.5),\n    `1` = brlavaan:::pen_huber(x, lb = lb, ub = Inf, thres = 1),\n    `2` = brlavaan:::pen_huber(x, lb = lb, ub = Inf, thres = 2)\n  ) |> \n  pivot_longer(-x) |>\n  ggplot(aes(x, value, color = name)) +\n  # annotate(\"rect\", xmin = lb, xmax = ub, ymin = -Inf, ymax = Inf, alpha = 0.2) +\n  geom_line() +\n  geom_vline(xintercept = c(lb), linetype = \"dashed\") +\n  labs(y = \"f(x)\", col = \"Threshold\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Comparison of left-bounded Huber penalty functions with different thresholds.](index_files/figure-html/fig-huber-comparison-left-bounded-1.png){#fig-huber-comparison-left-bounded width=672}\n:::\n:::\n\n\n<!-- {{< include _intro.qmd >}} -->\n\n<!-- ## Methodology -->\n\n<!-- {{< include _method.qmd >}} -->\n\n<!-- ## Simulation Study -->\n\n<!-- {{< include _simulation.qmd >}} -->\n\n<!-- ## Results -->\n\n<!-- {{< include _results.qmd >}} -->\n\n<!-- ## Discussion -->\n\n<!-- {{< include _discussion.qmd >}} -->\n\n## References {.unnumbered}\n\n::: {#refs}\n:::\n\n<!-- ## Appendix {.unnumbered} -->\n\n<!-- {{< include _appendix.qmd >}} -->\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}