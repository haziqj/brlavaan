<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plugin penalties • brlavaan</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plugin penalties">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">brlavaan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9009</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-manuscript" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Manuscript</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-manuscript">
<li><h6 class="dropdown-header" data-toc-skip>BR Estimation of SEM</h6></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/basics.html">The basics</a></li>
    <li><a class="dropdown-item" href="../articles/Function-dependencies.html">Function dependencies</a></li>
    <li><a class="dropdown-item" href="../articles/plugin-penalty.html">Plugin penalties</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/haziqj/sem-bias/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plugin penalties</h1>
                        <h4 data-toc-skip class="author">Haziq
Jamil</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/haziqj/sem-bias/blob/main/vignettes/articles/plugin-penalty.Rmd" class="external-link"><code>vignettes/articles/plugin-penalty.Rmd</code></a></small>
      <div class="d-none name"><code>plugin-penalty.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>For the iRBM method, we can use an additional plugin penalty to the
objective function. The plugin penalty acts to shrink the parameter
estimates towards some value, thus ensuring that the estimates are
finite. In some cases it might make sense to have penalties shrink to
zero, but for others, this is a bit too harsh (e.g. variance parameters
or other parameters which are in truth far away from zero). In these
cases, it is more useful to implement a bounded penalty, where such a
function acts within a pre-specified parameter range, and penalises the
objective function if the parameter estimates stray to the boundaries.
Yet another penalty function that will be explored is a penalty function
that shrinks the estimates towards some “ideal” variance-covariance
matrix.</p>
<p>Here are the penalty functions:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Ridge penalty (to target
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mo>*</mo></msup><annotation encoding="application/x-tex">x^*</annotation></semantics></math>)</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo stretchy="false" form="postfix">‖</mo><mi>x</mi><mo>−</mo><msup><mi>x</mi><mo>*</mo></msup><msup><mo stretchy="false" form="postfix">‖</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">
f(x) = \Vert x - x^* \Vert^2
</annotation></semantics></math> Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mo>*</mo></msup><annotation encoding="application/x-tex">x^*</annotation></semantics></math>
could be ideal parameter values, or could be used in conjunction with
bounds where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mo>*</mo></msup><annotation encoding="application/x-tex">x^*</annotation></semantics></math>
is the midpoint of the bounds.</p></li>
<li><p><strong>Ridge penalty with bounds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">l \leq x \leq u</annotation></semantics></math></strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>l</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>u</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mo stretchy="false" form="postfix">‖</mo><mi>x</mi><mo>−</mo><mi>l</mi><msup><mo stretchy="false" form="postfix">‖</mo><mn>2</mn></msup></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>x</mi><mo>&lt;</mo><mi>l</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mo stretchy="false" form="postfix">‖</mo><mi>x</mi><mo>−</mo><mi>u</mi><msup><mo stretchy="false" form="postfix">‖</mo><mn>2</mn></msup></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>x</mi><mo>&gt;</mo><mi>u</mi></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
f(x) = \begin{cases}
0 &amp; \text{if } l \leq x \leq u \\
\Vert x - l \Vert^2 &amp; \text{if } x &lt; l \\
\Vert x - u \Vert^2 &amp; \text{if } x &gt; u
\end{cases}
</annotation></semantics></math></p></li>
<li><p><strong>Huber penalty with bounds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">l \leq x \leq u</annotation></semantics></math></strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>y</mi><mn>2</mn></msup></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>y</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>&lt;</mo><mi>τ</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mo>−</mo><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>τ</mi><mn>2</mn></mfrac><mo>−</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>y</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>y</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>≥</mo><mi>τ</mi><mo>,</mo></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
f(x) =  \begin{cases} 
\frac{1}{2} y^2 &amp; \text{if } |y| &lt; \tau, \\[10pt]
-\tau \left(\frac{\tau}{2} - |y|\right) &amp; \text{if } |y| \geq \tau,
\end{cases}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
is some threshold (defaults to 1), and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>x</mi><mo>−</mo><mi>l</mi></mrow><mrow><mi>u</mi><mo>−</mo><mi>x</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>l</mi><mo>,</mo><mi>u</mi><mo>&lt;</mo><mi>∞</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>l</mi><mo>&lt;</mo><mi>∞</mi><mo>,</mo><mi>u</mi><mo>=</mo><mi>∞</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>l</mi><mo>,</mo><mi>u</mi><mo>=</mo><mi>∞</mi></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
y =
\begin{cases} 
\log\left(\frac{x - l}{u - x}\right) &amp; \text{if } l,u &lt; \infty \\
\log(x - l) &amp; \text{if } l &lt; \infty, u = \infty \\
0 &amp; \text{if } l,u = \infty
\end{cases}
</annotation></semantics></math></p></li>
<li>
<p><strong>Matrix norm to target matrix</strong></p>
<p>To be developed!</p>
</li>
</ol>
</div>
<div class="section level2">
<h2 id="comparison-of-penalty-functions">Comparison of penalty functions<a class="anchor" aria-label="anchor" href="#comparison-of-penalty-functions"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lb</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ub</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="fu">tibble</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    ridge <span class="op">=</span> <span class="fu">brlavaan</span><span class="fu">:::</span><span class="fu"><a href="../reference/plugin-penalties.html">pen_ridge</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    ridge_bounded <span class="op">=</span> <span class="fu">brlavaan</span><span class="fu">:::</span><span class="fu"><a href="../reference/plugin-penalties.html">pen_ridge_bound</a></span><span class="op">(</span><span class="va">x</span>, lb <span class="op">=</span> <span class="va">lb</span>, ub <span class="op">=</span> <span class="va">ub</span><span class="op">)</span>,</span>
<span>    huber_bounded <span class="op">=</span> <span class="fu">brlavaan</span><span class="fu">:::</span><span class="fu"><a href="../reference/plugin-penalties.html">pen_huber</a></span><span class="op">(</span><span class="va">x</span>, lb <span class="op">=</span> <span class="va">lb</span>, ub <span class="op">=</span> <span class="va">ub</span><span class="op">)</span>,</span>
<span>    huber_left_bounded <span class="op">=</span> <span class="fu">brlavaan</span><span class="fu">:::</span><span class="fu"><a href="../reference/plugin-penalties.html">pen_huber</a></span><span class="op">(</span><span class="va">x</span>, lb <span class="op">=</span> <span class="va">lb</span>, ub <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="va">lb</span>, xmax <span class="op">=</span> <span class="va">ub</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lb</span>, <span class="va">ub</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"f(x)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="plugin-penalty_files/figure-html/fig-penalty-functions-1.png" class="r-plt" alt="Comparison of penalty functions." width="700"><p class="caption">
Comparison of penalty functions.
</p>
</div>
</div>
<div class="section level2">
<h2 id="comparing-huber-penalty-thresholds">Comparing Huber penalty thresholds<a class="anchor" aria-label="anchor" href="#comparing-huber-penalty-thresholds"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lb</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">ub</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="fu">tibble</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    `0.5` <span class="op">=</span> <span class="fu">brlavaan</span><span class="fu">:::</span><span class="fu"><a href="../reference/plugin-penalties.html">pen_huber</a></span><span class="op">(</span><span class="va">x</span>, lb <span class="op">=</span> <span class="va">lb</span>, ub <span class="op">=</span> <span class="va">ub</span>, thres <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    `1` <span class="op">=</span> <span class="fu">brlavaan</span><span class="fu">:::</span><span class="fu"><a href="../reference/plugin-penalties.html">pen_huber</a></span><span class="op">(</span><span class="va">x</span>, lb <span class="op">=</span> <span class="va">lb</span>, ub <span class="op">=</span> <span class="va">ub</span>, thres <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    `2` <span class="op">=</span> <span class="fu">brlavaan</span><span class="fu">:::</span><span class="fu"><a href="../reference/plugin-penalties.html">pen_huber</a></span><span class="op">(</span><span class="va">x</span>, lb <span class="op">=</span> <span class="va">lb</span>, ub <span class="op">=</span> <span class="va">ub</span>, thres <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="va">lb</span>, xmax <span class="op">=</span> <span class="va">ub</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lb</span>, <span class="va">ub</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"f(x)"</span>, col <span class="op">=</span> <span class="st">"Threshold"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="plugin-penalty_files/figure-html/fig-huber-comparison-1.png" class="r-plt" alt="Comparison of Huber penalty functions with different thresholds." width="700"><p class="caption">
Comparison of Huber penalty functions with different thresholds.
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lb</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">ub</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="fu">tibble</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    `0.5` <span class="op">=</span> <span class="fu">brlavaan</span><span class="fu">:::</span><span class="fu"><a href="../reference/plugin-penalties.html">pen_huber</a></span><span class="op">(</span><span class="va">x</span>, lb <span class="op">=</span> <span class="va">lb</span>, ub <span class="op">=</span> <span class="cn">Inf</span>, thres <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    `1` <span class="op">=</span> <span class="fu">brlavaan</span><span class="fu">:::</span><span class="fu"><a href="../reference/plugin-penalties.html">pen_huber</a></span><span class="op">(</span><span class="va">x</span>, lb <span class="op">=</span> <span class="va">lb</span>, ub <span class="op">=</span> <span class="cn">Inf</span>, thres <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    `2` <span class="op">=</span> <span class="fu">brlavaan</span><span class="fu">:::</span><span class="fu"><a href="../reference/plugin-penalties.html">pen_huber</a></span><span class="op">(</span><span class="va">x</span>, lb <span class="op">=</span> <span class="va">lb</span>, ub <span class="op">=</span> <span class="cn">Inf</span>, thres <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># annotate("rect", xmin = lb, xmax = ub, ymin = -Inf, ymax = Inf, alpha = 0.2) +</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lb</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"f(x)"</span>, col <span class="op">=</span> <span class="st">"Threshold"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="plugin-penalty_files/figure-html/fig-huber-comparison-left-bounded-1.png" class="r-plt" alt="Comparison of left-bounded Huber penalty functions with different thresholds." width="700"><p class="caption">
Comparison of left-bounded Huber penalty functions with different
thresholds.
</p>
</div>
</div>
<div class="section level2">
<h2 id="creating-your-own-plugin-penalty-function">Creating your own plugin penalty function<a class="anchor" aria-label="anchor" href="#creating-your-own-plugin-penalty-function"></a>
</h2>
<p>To be developed…</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://haziqj.ml/" class="external-link">Haziq Jamil</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
